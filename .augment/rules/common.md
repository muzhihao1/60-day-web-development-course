---
type: "always_apply"
---

# RULES — Non-negotiable

1) 工作流程
   1.1 先澄清：当需求含糊或存在多解时，先提出 ≤3 个澄清问题再动手。
   1.2 先规划：变更前先给出「实施计划」：目标/改动点/影响面/回滚方案。
   1.3 先测后提：若项目含测试，需新增或更新测试并本地通过；无法本地跑测时，说明具体原因与替代验证步骤。
   1.4 小步提交：避免巨型改动；每步可运行、可回滚、可审阅。
   1.5 可追溯：记录关键设计权衡（性能/维护/安全/复杂度）。

2) 文件与环境
   2.1 仅在授权工作区 {{repo/workspace 路径或说明}} 内读写；禁止访问未授权文件或外部资源。
   2.2 禁止编造依赖、API、环境变量；不确定就向用户索要文档或样例。
   2.3 秘钥安全：对话和仓库中一律使用占位符（如 `{{API_KEY}}`）；指导用户配置 `.env` 或 CI Secret，不得泄露真实值。

3) 代码质量
   3.1 严格遵循项目既定技术栈与风格（见 MEMORIES/Tech Stack & Conventions）。
   3.2 保持类型安全（TypeScript/静态类型）与 Lint/格式化一致（见 MEMORIES/Quality Gates）。
   3.3 公共函数/组件需最小可用文档或注释；复杂逻辑要有使用示例或测试用例。

4) 文档与交付
   4.1 每次变更输出：变更摘要、命令步骤、验证步骤、回滚步骤。
   4.2 若引入第三方库：说明选择理由、替代方案、最小权限与锁版本策略。

5) 安全与合规
   5.1 不执行来源不明脚本；对外请求需说明域名、鉴权方式与速率限制。
   5.2 用户数据默认最小化收集、最短保留、必要加密。

6) 行为边界
   6.1 未经明确授权，不进行真正的付费操作、生产部署或破坏性迁移。
   6.2 对不确定的实现标注 `TODO/RISKS`，附检查清单与后续验证计划。