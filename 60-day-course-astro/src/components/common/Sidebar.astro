---
export interface Props {
  currentPhase?: number;
  currentDay?: number;
}

const { currentPhase, currentDay } = Astro.props;

// è¯¾ç¨‹ç»“æ„å®šä¹‰
const courseStructure = [
  {
    phase: 1,
    title: 'ç°ä»£WebåŸºç¡€',
    badge: 'new',
    days: 12,
    items: [
      { day: 1, title: 'Gitä¸ç‰ˆæœ¬æ§åˆ¶åŸºç¡€' },
      { day: 2, title: 'HTML5è¯­ä¹‰åŒ–ä¸å¯è®¿é—®æ€§' },
      { day: 3, title: 'è¡¨å•è®¾è®¡ä¸åª’ä½“å…ƒç´ ' },
      { day: 4, title: 'CSS3å¸ƒå±€ç³»ç»Ÿæ·±å…¥' },
      { day: 5, title: 'å“åº”å¼è®¾è®¡ä¸CSS Grid' },
      { day: 6, title: 'CSSåŠ¨ç”»ä¸è¿‡æ¸¡æ•ˆæœ' },
      { day: 7, title: 'ç°ä»£CSSæ¶æ„' },
      { day: 8, title: 'æ€§èƒ½ä¼˜åŒ–åŸºç¡€' },
      { day: 9, title: 'æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç²¾é€š' },
      { day: 10, title: 'Webæ ‡å‡†ä¸å…¼å®¹æ€§' },
      { day: 11, title: 'é¡¹ç›®ï¼šä¸ªäººä½œå“é›†ç½‘ç«™(ä¸Š)' },
      { day: 12, title: 'é¡¹ç›®ï¼šä¸ªäººä½œå“é›†ç½‘ç«™(ä¸‹)' },
    ]
  },
  {
    phase: 2,
    title: 'JavaScriptç°ä»£ç¼–ç¨‹',
    badge: 'hot',
    days: 12,
    items: [
      { day: 13, title: 'ES6+è¯­æ³•ç²¾é€š' },
      { day: 14, title: 'å¼‚æ­¥ç¼–ç¨‹ä¸Promise' },
      { day: 15, title: 'DOMæ“ä½œä¸äº‹ä»¶ç³»ç»Ÿ' },
      { day: 16, title: 'å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€' },
      { day: 17, title: 'é¢å‘å¯¹è±¡ç¼–ç¨‹' },
      { day: 18, title: 'æ¨¡å—åŒ–ä¸æ„å»ºå·¥å…·' },
      { day: 19, title: 'TypeScriptå…¥é—¨' },
      { day: 20, title: 'æµè§ˆå™¨APIæ·±å…¥' },
      { day: 21, title: 'æ•°æ®ç»“æ„ä¸ç®—æ³•' },
      { day: 22, title: 'è®¾è®¡æ¨¡å¼å®è·µ' },
      { day: 23, title: 'é¡¹ç›®ï¼šä»»åŠ¡ç®¡ç†åº”ç”¨(ä¸Š)' },
      { day: 24, title: 'é¡¹ç›®ï¼šä»»åŠ¡ç®¡ç†åº”ç”¨(ä¸‹)' },
    ]
  },
  {
    phase: 3,
    title: 'Reactç°ä»£å¼€å‘',
    badge: 'pro',
    days: 16,
    items: [
      { day: 25, title: 'Reactæ ¸å¿ƒæ¦‚å¿µ' },
      { day: 26, title: 'ç»„ä»¶è®¾è®¡ä¸Props' },
      { day: 27, title: 'Stateä¸ç”Ÿå‘½å‘¨æœŸ' },
      { day: 28, title: 'Hooksæ·±å…¥ç†è§£' },
      { day: 29, title: 'Contextä¸çŠ¶æ€ç®¡ç†' },
      { day: 30, title: 'React Routerè·¯ç”±' },
      { day: 31, title: 'è¡¨å•å¤„ç†ä¸éªŒè¯' },
      { day: 32, title: 'æ€§èƒ½ä¼˜åŒ–æŠ€å·§' },
      { day: 33, title: 'æµ‹è¯•é©±åŠ¨å¼€å‘' },
      { day: 34, title: 'ReduxçŠ¶æ€ç®¡ç†' },
      { day: 35, title: 'APIé›†æˆä¸æ•°æ®è·å–' },
      { day: 36, title: 'è®¤è¯ä¸æˆæƒ' },
      { day: 37, title: 'é«˜çº§ç»„ä»¶æ¨¡å¼' },
      { day: 38, title: 'é¡¹ç›®ï¼šç”µå•†å‰ç«¯(ä¸€)' },
      { day: 39, title: 'é¡¹ç›®ï¼šç”µå•†å‰ç«¯(äºŒ)' },
      { day: 40, title: 'é¡¹ç›®ï¼šç”µå•†å‰ç«¯(ä¸‰)' },
    ]
  },
  {
    phase: 4,
    title: 'åç«¯å¼€å‘ä¸æ•°æ®åº“',
    days: 12,
    items: [
      { day: 41, title: 'Node.jsåŸºç¡€' },
      { day: 42, title: 'Expressæ¡†æ¶å…¥é—¨' },
      { day: 43, title: 'RESTful APIè®¾è®¡' },
      { day: 44, title: 'æ•°æ®åº“åŸºç¡€ä¸SQL' },
      { day: 45, title: 'MongoDBä¸Mongoose' },
      { day: 46, title: 'ç”¨æˆ·è®¤è¯ä¸JWT' },
      { day: 47, title: 'æ–‡ä»¶ä¸Šä¼ ä¸å¤„ç†' },
      { day: 48, title: 'WebSocketå®æ—¶é€šä¿¡' },
      { day: 49, title: 'ç¼“å­˜ä¸æ€§èƒ½ä¼˜åŒ–' },
      { day: 50, title: 'é”™è¯¯å¤„ç†ä¸æ—¥å¿—' },
      { day: 51, title: 'é¡¹ç›®ï¼šåšå®¢API(ä¸Š)' },
      { day: 52, title: 'é¡¹ç›®ï¼šåšå®¢API(ä¸‹)' },
    ]
  },
  {
    phase: 5,
    title: 'å…¨æ ˆå¼€å‘ä¸éƒ¨ç½²',
    days: 8,
    items: [
      { day: 53, title: 'Dockerå®¹å™¨åŒ–' },
      { day: 54, title: 'CI/CDæµç¨‹' },
      { day: 55, title: 'äº‘æœåŠ¡ä¸éƒ¨ç½²' },
      { day: 56, title: 'ç›‘æ§ä¸æ—¥å¿—ç®¡ç†' },
      { day: 57, title: 'å®‰å…¨æœ€ä½³å®è·µ' },
      { day: 58, title: 'æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–' },
      { day: 59, title: 'é¡¹ç›®ï¼šç¤¾äº¤åª’ä½“åº”ç”¨(ä¸Š)' },
      { day: 60, title: 'é¡¹ç›®ï¼šç¤¾äº¤åª’ä½“åº”ç”¨(ä¸‹)' },
    ]
  }
];

// è®¡ç®—æ€»è¿›åº¦
const totalDays = 60;
const completedDays = currentDay || 0;
const progressPercentage = Math.round((completedDays / totalDays) * 100);
---

<div class="p-4">
  <!-- è¿›åº¦æ¦‚è§ˆ -->
  <div class="mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
    <h3 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
      å­¦ä¹ è¿›åº¦
    </h3>
    <div class="progress-bar mb-2">
      <div 
        class="progress-bar-fill" 
        style={`width: ${progressPercentage}%`}
      ></div>
    </div>
    <p class="text-xs text-gray-600 dark:text-gray-400">
      å·²å®Œæˆ {completedDays}/{totalDays} å¤© ({progressPercentage}%)
    </p>
  </div>
  
  <!-- è¯¾ç¨‹å¯¼èˆª -->
  <div class="space-y-4">
    {courseStructure.map((phase) => (
      <div key={phase.phase} class="border-b border-gray-200 dark:border-gray-700 pb-4">
        <div class="flex items-center justify-between mb-2">
          <h4 class="font-semibold text-gray-900 dark:text-white">
            ç¬¬{phase.phase}é˜¶æ®µï¼š{phase.title}
          </h4>
          {phase.badge && (
            <span class={`badge badge-${phase.badge}`}>
              {phase.badge === 'new' ? 'åŸºç¡€' : phase.badge === 'hot' ? 'æ ¸å¿ƒ' : 'è¿›é˜¶'}
            </span>
          )}
        </div>
        
        <ul class="space-y-1">
          {phase.items.map((item) => {
            const isActive = currentPhase === phase.phase && currentDay === item.day;
            const isCompleted = currentDay ? item.day < currentDay : false;
            
            return (
              <li key={item.day}>
                <a
                  href={`/course/phase-${phase.phase}/day-${item.day}`}
                  class={`block px-3 py-2 text-sm rounded-md transition-colors duration-200 ${
                    isActive
                      ? 'bg-primary text-white font-medium'
                      : isCompleted
                      ? 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'
                      : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'
                  }`}
                >
                  <span class="flex items-center">
                    {isCompleted && (
                      <svg class="w-4 h-4 mr-2 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                      </svg>
                    )}
                    Day {item.day}: {item.title}
                  </span>
                </a>
              </li>
            );
          })}
        </ul>
      </div>
    ))}
  </div>
  
  <!-- å¿«é€Ÿé“¾æ¥ -->
  <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
      å¿«é€Ÿé“¾æ¥
    </h4>
    <ul class="space-y-2">
      <li>
        <a href="/projects" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary">
          ğŸ“ ç»¼åˆé¡¹ç›®
        </a>
      </li>
      <li>
        <a href="/resources" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary">
          ğŸ“š å­¦ä¹ èµ„æº
        </a>
      </li>
      <li>
        <a href="/community" class="text-sm text-gray-600 dark:text-gray-400 hover:text-primary">
          ğŸ’¬ ç¤¾åŒºè®¨è®º
        </a>
      </li>
    </ul>
  </div>
</div>